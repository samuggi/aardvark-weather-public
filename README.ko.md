# Aardvark 날씨 모델

이 저장소에는 Aardvark 날씨 모델(https://www.nature.com/articles/s41586-025-08897-0)을 실행하는 데 사용되는 코드와 가중치가 포함되어 있습니다. 학습된 모델을 실행하여 예측을 생성하는 방법을 보여주기 위해 샘플 데이터, 모델 가중치 및 코드를 제공합니다.

## 모델 가중치
논문에 제시된 학습된 모델의 가중치는 `https://huggingface.co/datasets/av555/aardvark-weather/tree/main/trained_model`에서 제공됩니다.
이 폴더에는 인코더, 디코더, 프로세서에 대한 가중치와 하루 리드 타임에 대한 종단 간 미세 조정된 가중치가 있습니다.
디코더 및 종단 간 모델의 경우 온도와 풍속 모두에 대한 가중치를 제공합니다.

## 데이터
샘플 데이터는 `data/sample_data_final.pkl`에 제공됩니다. 또한 예측 플롯을 생성하는 데 사용되는 정규화 계수를 제공합니다. 모델에 전달되는 데이터의 각 시간 슬라이스에 포함된 내용에 대한 시각화는 notebooks/data_demo.ipynb를 참조하십시오. 자체 종단 간 모델 학습에 관심 있는 분들을 위해 https://huggingface.co/datasets/av555/aardvark-weather에서 논문에 활용된 데이터 소스에 대한 기계 학습 준비 데이터 세트를 추가로 준비했습니다.

## 예측 노트북
학습된 모델을 사용하여 예측을 생성하는 방법을 보여주는 노트북은 `notebooks/` 폴더에 포함되어 있습니다.
Aardvark는 다양한 형태의 예측을 생성합니다.
`forecast_demo.ipynb` 노트북은 전체 Aardvark 날씨 모델을 로드하고, 샘플 데이터에서 예측을 생성하며, 출력된 전역 그리드 및 관측소 예측의 시각화를 제공합니다.
`e2e_finetune_demo.ipynb` 노트북은 종단 간 미세 조정된 모델을 사용하여 샘플 데이터에서 최적화된 관측소 예측을 생성하는 시연을 제공합니다.

## 학습
Aardvark 날씨 모델은 여러 단계로 학습됩니다.
모델을 학습시키기 위한 스크립트는 `training/`에 포함되어 있습니다.
세 가지 주요 모듈의 학습은 `train_module.py`에서 처리되고, 프로세서 미세 조정은 `finetune.py`에서, 종단 간 미세 조정은 `e2e_train.py`에서 처리됩니다.

__참고:__ 아래 "인코더", "프로세서", "디코더" 섹션의 명령 및 관련 스크립트는 특정 학습 컴퓨팅 인프라에 대한 로컬 데이터 로딩 파이프라인 설정에 의존하므로 실행할 수 없습니다. 이러한 학습 및 미세 조정 명령의 목적은 투명성을 위해 그리고 학습 프로세스의 세부 사항에 관심 있는 사람들을 위해 학습 프로세스의 중요한 사항을 설명하는 것이며 실행 가능한 버전을 제공하는 것이 아닙니다.

### 인코더
인코더를 학습시키려면 다음을 실행하십시오.
```
bash train_encoder.sh
```

### 프로세서
프로세서를 사전 학습시키려면 다음 코드를 사용합니다.
```
bash train_processor.sh
```

프로세서를 미세 조정하려면 다음 코드를 사용합니다.
```
bash finetune.sh
```

### 디코더
디코더를 학습시키려면 다음 코드를 사용합니다.
```
bash train_decoder.sh
```

### 종단 간
모델을 종단 간으로 조정하려면 다음 코드를 사용합니다.
```
bash train_e2e.sh
```
## 자주 묻는 질문 (FAQ)

#### 모델 학습에 사용된 데이터에 접근할 수 있나요?
2007년부터 2019년까지의 관측 데이터를 24시간 해상도로 제공하는 데이터 세트를 https://huggingface.co/datasets/av555/aardvark-weather에서 제공합니다. 이를 통해 다른 사람들이 자체적인 종단 간 날씨 모델을 개발하고 이 작업을 위한 ML 아키텍처의 방대한 설계 공간을 탐색할 수 있기를 바랍니다.

#### 모델을 실시간으로 실행할 수 있나요?
안타깝게도 이 초기 프로토타입에 사용된 데이터 세트는 실시간으로 사용할 수 없습니다. 그러나 현재 완전한 운영 시스템인 Aardvark 2.0을 구축하는 과정에 있습니다. 이에 대한 업데이트는 여기에 제공될 예정입니다.

#### 이 모델은 다른 AI 모델보다 해상도가 낮습니다. 이를 개선할 계획이 있나요?
현재 더 넓은 범위의 기압 수준에 대해 0.25도에서 실행되는 새 버전의 모델을 개발 중입니다.

#### 모델 및 데이터 세트의 추가 버전이 제공될 예정인가요?
네, 이 프로젝트는 진행 중이며 이 데이터 세트와 모델을 계속 업데이트하는 것을 목표로 합니다. 현재 진행 중인 업데이트에는 실시간 데이터 피드를 갖춘 완전한 운영 시스템 개발, 현재 과거 데이터 세트를 2025년까지 확장, 추가 장비 포함 등이 있습니다. 새로운 제품이 출시될 때 업데이트를 받으려면 'Aardvark updates'라는 제목으로 av555@cam.ac.uk로 이메일을 보내주십시오.

#### 이 데이터 세트를 상업적으로 사용할 수 있나요?
데이터 세트는 비상업적 비파생 라이선스로 배포됩니다. 이는 소스 데이터 세트에서 상속된 라이선스 때문입니다.
